<!-- templates/order_detail.html -->
{% extends 'bases/base-nav.html' %}
{% load qr_code %}

{% block nav %}
    <div class="container-fluid">
        <div class="navbar-brand fw-bold">Detalles</div>
        <a class="btn" href="{{ request.META.HTTP_REFERER }}"><i class="bi bi-x-lg"></i></a>
    </div>
{% endblock %}

{% block content %}
    <div class="container mb-4">
        {% for message in messages %}
            <div class="mt-2 mb-3" role="alert">
                <div class="alert alert-primary d-flex align-items-center">
                    <i class="bi bi-check-circle-fill"></i><span class="ps-1">{{ message }}</span>
                </div>
            </div>
        {% endfor %}

        <div class="text-center mt-2 mb-3">
            <img class="rounded border border-secondary-subtle"
                 src="{% qr_url_from_text request.build_absolute_uri border=3 size=14 %}">
        </div>

        {% include "components/order_details_card.html" with order=order %}


        {# Detalles de reporte #}
        {% if order.get_report %}
            <div class="card mt-3">
                <div class="card-header small text-muted">
                    Reporte
                </div>
                <p class="card-body pb-0">{{ order.get_report.details }}</p>
            </div>
        {% endif %}


        <div class="mt-3">
            {% include "components/order_articles_card.html" with order=order %}
        </div>
    </div>

    {# Bot√≥n de Cancelar para ordenes pendientes #}
    {% if order.status == 'pending' %}
        <div class="fixed-bottom">
            <div class="d-grid my-2 mx-2">
                <button class="btn btn-primary btn-lg" type="button">Cancelar Orden</button>
            </div>
        </div>
    {% endif %}
{% endblock %}
