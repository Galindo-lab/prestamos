<!-- templates/order_detail.html -->
{% extends "bases/base-nav.html" %}

{% comment %}

        <a class="navbar-brand fw-light col-1" href="{{ request.META.HTTP_REFERER }}">
            <i class="bi bi-arrow-left"></i>
        </a>

        <div class="flex-fill text-center">
            Detalles
        </div>

        <div class="col-1">

        </div>


        <div class="">
            <a class="btn" href="{{ request.META.HTTP_REFERER }}">
                <i class="bi bi-arrow-left"></i>
            </a>
            Detalles
        </div>

{% endcomment %}

{% block nav %}

    <div class="container-fluid ">
        <div class="navbar-brand">
            Detalles
        </div>
        <a class="btn" href="{{ request.META.HTTP_REFERER }}">
            <i class="bi bi-x-lg"></i>
        </a>
    </div>

{% endblock %}



{% block content %}


    <div class="container">

        <div class="card mb-2">
            <div class="card-header"><i class="bi bi-info-circle"></i> Información</div>

            <div class="card-body ">
                <div class="row">
                    <div class="row align-items-start">

                        <div class="col">
                            <span class="fw-medium"><i class="bi bi-box-arrow-in-right"></i> Entrega</span>
                            <br>
                            <span class="text-secondary text-nowrap">{{ order.order_date|date:"d M · H:i" }}</span>
                        </div>

                        <div class="col border-start">
                            <span class="fw-medium"><i class="bi bi-box-arrow-in-left"></i> Retorno</span>
                            <br>
                            <span class="text-secondary text-nowrap">{{ order.return_date|date:"d M · H:i" }}</span>
                        </div>

                    </div>
                </div>


            </div>

            <div class="card-footer">
                {% if order.status in 'cancelled, rejected' %}
                    <span class="badge text-bg-danger">{{ order.get_status_display }}</span>
                {% elif order.status in 'approved, delivered, returned' %}
                    <span class="badge text-bg-success">{{ order.get_status_display }}</span>
                {% else %}
                    <span class="badge text-bg-secondary">{{ order.get_status_display }}</span>
                {% endif %}

            </div>


        </div>







        {% if order.get_report %}
            <div class="card my-3">
                <div class="card-header"><i class="bi bi-exclamation-circle"></i> Reporte</div>
                <div class="card-body">
                    {{ order.get_report.details }}
                </div>
            </div>
        {% endif %}





        <div class="card my-3 ">
            <div class="card-header"><i class="bi bi-list-ul"></i> Artículos</div>
            <ul class="list-group list-group-flush">

                {% for unit in order.units.all %}

                    <li class="list-group-item d-flex justify-content-between align-items-start">
                        <div class="ms-2 me-auto">
                            <div class="fw-medium">{{ unit.item.name }}</div>
                            {{ unit.serial_number }}
                        </div>
                    </li>

                    <li class="list-group-item d-flex justify-content-between align-items-start">
                        <div class="ms-2 me-auto">
                            <div class="fw-medium">{{ unit.item.name }}</div>
                            {{ unit.serial_number }}
                        </div>
                    </li>

                    <li class="list-group-item d-flex justify-content-between align-items-start">
                        <div class="ms-2 me-auto">
                            <div class="fw-medium">{{ unit.item.name }}</div>
                            {{ unit.serial_number }}
                        </div>
                    </li>

                {% endfor %}
{% comment %}

        <a href="{% url 'order_aprove' order.pk %}">autorizar</a>
        <a href="{% url 'order_report' order.pk %}">Reportar</a>

        {% endcomment %}

            </ul>
        </div>
    </div>





    {% for message in messages %}
        <ul class="message">
            <li>{{ message }}</li>
        </ul>
    {% endfor %}


    {% if order.status == 'pending' %}
        <div class="container">
            <div class="d-grid mb-3">
                <button class="btn btn-primary" type="button">Cancelar Orden</button>
            </div>
        </div>
    {% endif %}



{% endblock %}
